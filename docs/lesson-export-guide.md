# 教案导出功能使用指南

> **版本**: v1.0
> **更新日期**: 2026-02-07
> **适用角色**: 教师、管理员

---

## 概述

教案导出功能允许教师将教案导出为多种格式（Word、PDF、PPT、Markdown），支持自定义模板和实时进度追踪。本指南将帮助您快速掌握该功能的使用方法。

### 功能特性

- **多格式导出**: 支持 Word (.docx)、PDF (.pdf)、PPT (.pptx)、Markdown (.md)
- **模板管理**: 系统预设模板 + 自定义模板
- **实时进度**: WebSocket 实时推送导出进度
- **章节选择**: 灵活选择需要导出的教案章节
- **断线重连**: 网络中断自动恢复
- **并发处理**: 支持多个导出任务同时进行

---

## 快速开始

### 前置条件

1. 已登录教师账号
2. 至少有一份已创建的教案
3. 浏览器支持 WebSocket (现代浏览器均支持)

### 基本流程

```
选择教案 → 配置选项 → 开始导出 → 实时追踪 → 下载文件
```

---

## 详细使用说明

### 1. 进入导出页面

**路径**: 教师端 → 教案导出

或在浏览器中访问:
```
http://your-domain/teacher/lesson-export
```

### 2. 选择教案

点击「添加教案」按钮，从弹出的教案列表中选择需要导出的教案。

| 步骤 | 操作 |
|------|------|
| 1 | 点击「添加教案」按钮 |
| 2 | 在列表中选择教案（支持搜索） |
| 3 | 点击「确认」完成选择 |

**提示**: 可以同时选择多个教案进行批量导出。

### 3. 配置导出选项

#### 3.1 选择导出格式

| 格式 | 文件扩展名 | 适用场景 |
|------|-----------|----------|
| **Word** | .docx | 需要进一步编辑、修改 |
| **PDF** | .pdf | 打印、分发、存档 |
| **PPT** | .pptx | 课堂展示、演示 |
| **Markdown** | .md | 版本控制、协作编辑 |

#### 3.2 选择模板

**系统预设模板**:
- 标准教案模板
- 简洁教案模板
- 详细教案模板

**自定义模板**:
- 点击「管理模板」
- 创建或编辑自定义模板
- 在导出时选择使用

#### 3.3 选择导出章节

勾选需要导出的章节:
- ☑️ 课程概述
- ☑️ 教学目标
- ☑️ 词汇表
- ☑️ 语法重点
- ☑️ 教学结构
- ☑️ 教学材料
- ☑️ 练习题

#### 3.4 其他选项

- ☑️ **包含教师备注**: 在文档中显示教师备注
- ☑️ **包含练习答案**: 在练习题后附上答案
- ☑️ **显示页码**: 在文档中添加页码
- ☑️ **包含目录**: 在文档开头生成目录

### 4. 开始导出

配置完成后，点击「开始导出」按钮。

系统将:
1. 创建导出任务
2. 建立 WebSocket 连接
3. 开始文档生成
4. 实时推送进度

### 5. 追踪导出进度

导出进度对话框会显示:

```
┌─────────────────────────────────────┐
│  导出进度                            │
├─────────────────────────────────────┤
│  [████████░░░░░░] 50%               │
│  当前: 生成文档中...                 │
├─────────────────────────────────────┤
│  时间线:                             │
│  ✓ 创建任务                          │
│  ✓ 加载教案数据                      │
│  ✓ 渲染教案内容                      │
│  → 生成文档                          │
│  ⏸ 保存文档                          │
├─────────────────────────────────────┤
│  状态: ● 已连接                       │
└─────────────────────────────────────┘
```

**进度阶段**:
1. 创建任务 (0-10%)
2. 加载教案数据 (10-30%)
3. 渲染教案内容 (30-50%)
4. 生成文档 (50-80%)
5. 保存文档 (80-100%)

### 6. 下载文件

导出完成后，点击「立即下载」按钮获取生成的文件。

文件命名格式:
```
{教案标题}_{格式}.{扩展名}
例: 基础英语课程_unit1.docx
```

---

## 高级功能

### 自定义模板

#### 创建新模板

1. 点击「管理模板」→「新建模板」
2. 填写模板信息:
   - **模板名称**: 例如「我的英语教案模板」
   - **导出格式**: Word/PDF/PPT
   - **模板描述**: 简要说明模板用途

3. 上传模板文件 (可选):
   - Word: .docx 文件
   - PPT: .pptx 文件

4. 定义模板变量:
   | 变量名 | 类型 | 说明 |
   |--------|------|------|
   | `lesson_title` | 文本 | 教案标题 |
   | `level` | 文本 | 课程级别 |
   | `duration` | 数字 | 课程时长（分钟） |
   | `objectives` | 多行文本 | 教学目标 |

5. 点击「保存模板」

#### 使用自定义模板

在导出选项中:
1. 点击「使用模板」下拉框
2. 选择自定义模板
3. 系统会根据模板变量自动填充内容

### 批量导出

1. 在教案列表中勾选多个教案
2. 统一配置导出选项
3. 点击「批量导出」

**注意**: 批量导出会创建多个独立的导出任务，需要分别下载。

### 预览功能

在开始导出前，可以使用「预览效果」功能查看导出结果：

1. 配置好导出选项
2. 点击「预览效果」
3. 系统生成预览版本（仅用于查看）

---

## 常见问题

### Q: 导出需要多长时间？

**A**: 取决于教案大小和格式：
- 简单教案 (Word): 5-15 秒
- 复杂教案 (PDF/PPT): 15-45 秒
- 包含大量图片/表格: 可能需要更长时间

### Q: 导出失败了怎么办？

**A**:
1. 检查网络连接是否正常
2. 查看错误消息了解具体原因
3. 点击「重试」按钮重新导出
4. 如问题持续，请联系技术支持

### Q: 可以导出哪些内容？

**A**:
- 教案基本信息（标题、级别、时长）
- 教学目标
- 词汇表
- 语法重点
- 教学流程
- 教学材料
- 练习题

### Q: 导出的文件可以编辑吗？

**A**:
- **Word (.docx)**: 完全可编辑
- **PPT (.pptx)**: 完全可编辑
- **PDF**: 仅可批注，不可直接编辑
- **Markdown**: 文本格式，完全可编辑

### Q: 如何分享导出的文件？

**A**:
1. 下载文件到本地
2. 通过邮件、云存储等方式分享
3. 或直接打印成纸质版本

### Q: 导出历史记录保存在哪里？

**A**:
- 导出历史记录保存在系统中 7 天
- 7 天后自动清理
- 下载的文件会保存在您的浏览器下载目录

---

## 技术支持

### 获取帮助

- **用户手册**: 本文档
- **视频教程**: [链接]
- **在线支持**: support@example.com
- **问题反馈**: 在系统内点击「反馈」按钮

### 报告问题

如遇到问题，请提供:
1. 问题描述
2. 截图或错误消息
3. 使用的浏览器和版本
4. 操作步骤

---

## 更新日志

### v1.0 (2026-02-07)
- ✨ 首次发布
- ✨ 支持 4 种导出格式
- ✨ 实时进度推送
- ✨ 自定义模板功能
- ✨ 批量导出支持

---

## 附录

### 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl/Cmd + S` | 保存模板（在模板编辑中） |
| `Esc` | 关闭对话框 |
| `Enter` | 确认操作 |

### 支持的浏览器

| 浏览器 | 最低版本 | WebSocket 支持 |
|--------|----------|----------------|
| Chrome | 90+ | ✅ |
| Firefox | 88+ | ✅ |
| Safari | 14+ | ✅ |
| Edge | 90+ | ✅ |

### 文件大小限制

| 格式 | 最大文件大小 |
|------|-------------|
| Word | 50 MB |
| PDF | 50 MB |
| PPT | 50 MB |
| Markdown | 10 MB |

---

*本文档最后更新于 2026-02-07*
